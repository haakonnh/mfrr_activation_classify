
\subsection{Overview of Methodological Approach}
The methodological approach adopted in this project is visualized in Figure
\ref{fig:methodology_overview}. The first step, data collection, involves
gathering relevant datasets from various sources, including Nord Pool, NUCS, and
ENTSO-E. The collected data is then preprocessed and cleaned in the second step.
These first steps are uniquely colored red in the figure to indicate that they
are mostly one-time efforts required to set up the dataset for further.

The third step, feature engineering, involves creating and selecting relevant
features, i.e. attributes in the dataset that help the model learn patterns
related to mFRR activations. The feature-engineered dataset is subsequently sent
to the model training algorithm. Here, machine learning techniques are applied
to train classification models using the prepared dataset. Then, the trained
models are evaluated with the relevant metrics to assess their predictive
performance. These three steps are colored purple, indicating that they are
iterative processes that make up the bulk of the work invested in this project. 

Evaluation results are interpreted in the last step indicated by the blue box.
This step is unique as it only involves deriving insights and conclusions from
the previous steps. Methodological feedback loops flow from the interpretation
step back to the feature engineering, model training, and evaluation steps.
These feedback loops represent the iterative nature of the methodology, where
insights gained from interpretation inform further refinements and improvements
in the earlier stages of the process. 

Performance is difficult to evaluate in a vacuum. A \textit{naive} baseline model 
was therefore developed to provide a reference point for assessing the
performance of more sophisticated models. The naive model assumes the target
$t+4$ to equal the most recent known activation direction, i.e. at $t-4$. 
This approach captures the persistence often observed in mFRR activations, where
future activations tend to correlate with recent activations. The naive model's
performance is evaluated using the same metrics as the more complex models,
allowing for direct comparison. 



\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{Images/MethodologyDiagram.png}
    \caption{Overview of the methodological approach used in this project.}
    \label{fig:methodology_overview}
\end{figure}

Methodological specifics are detailed in the subsequent sections, which follow
the logical structure of the workflow illustrated in Figure
\ref{fig:methodology_overview}. Each section elaborates on one stage of the
approach, including data sources, preprocessing, feature construction, and model
evaluation. While the methodology was implemented programmatically, the focus of
the following sections is on the underlying methodological choices, assumptions,
and constraints that govern the modeling process rather than on implementation
details. 




\subsection{Data Sources}\label{sec:data-and-preprocessing}
This section introduces the data sources used in this project and describes how
the data was gathered and preprocessed for further use in model training and evaluation.
The gathered data spans a period from January 1, 2024, to December 4, 2025, 
providing a comprehensive view of NO1 mFRR activation patterns over nearly two
years. 


\subsubsection{Nord Pool}

Nord Pool provides market and system data in the Nordic region.
Data was downloaded manually through the Nord 
Pool data portal in yearly chunks \autocite{PowerMarketData}.
A manual approach was necessary due to the Nord Pool API not being 
available for this project. Data API access requires a commercial agreement with
Nord Pool, which was not obtained. This is not an 
issue for this project and research as real-time data is not required for
model training and evaluation. If the models were to be deployed in a
real-time setting, however, access to real-time data through the API would be 
essential. The following subsections describe the specific datasets obtained
from Nord Pool. 


\paragraph{mFRR activation data.}
The primary dataset used in this study consists of manual Frequency
Restoration Reserves (mFRR) activation data from the Nordic electricity
market, specifically for the bidding zone NO1. This data includes accepted 
and activated up- and down-regulation bids at a 15-minute resolution. The 
activated volumes provide the target variable for the prediction models, indicating
whether an mFRR activation occurred in a given 15-minute interval. 

\paragraph{Cross-zonal flows.}
Cross-zonal flows refer to the electricity flows between different
bidding zones in the Nordic market. In this project, only cross-zonal flows
involving the NO1 bidding zone are considered: flows between NO1 and SE3, NO1 and
NO3, NO1 and NO5, and NO1 and SE3. These flows are crucial for maintaining
grid stability and optimizing the use of available resources. The dataset
includes information on cross-zonal flows to provide additional context for
mFRR activations. 

\paragraph{Load and production data.}
Load and production forecasts provide insights into the expected
system state. Forecast may on their own provide valuable information about
potential mFRR activations, but when combined with actual load and production
data, the model can learn to identify discrepancies between expected and
actual system states. Such discrepancies often lead to imbalances that require
mFRR activations to restore balance. The different production sources 
(e.g., hydro, wind, thermal) have varying characteristics and impacts on grid
stability. Among them, wind power is particularly relevant due to its
intermittent nature, which can lead to sudden changes in generation levels.
Wind power production data is therefore predicted to have the biggest impact
on mFRR activations among the different production types.



Load/consumption data is much simpler in nature, as \textit{who} or \textit{what},
essentially the source of consumption, is not as relevant as the source of production.
Consumption forecasts and actual consumption data can still be useful, however,
as sudden changes in consumption patterns can lead to imbalances that
require mFRR activations. 

\subsubsection{NUCS}
NUCS, or the Nordic Unavailability Collection System, is a service for
collection of data on unavailable data in the Nordic power system. NUCS is an
important part of this project, as it provides otherwise unavailable data that
served as features in the models. NUCS is unique from the other data sources
used in this project, as it provides data through an API (Application
Programming Interface) \autocite{StaticContentNordic}. This allows for automated
data retrieval, which is especially useful for real-time applications. This
project does not have access to comprehensive real-time data, and the NUCS API
was thus only used to gather historical data for the training and evaluation of
the models. An algorithm was developed, however, to automatically retrieve
real-time data from the NUCS API for potential future real-time applications.

\paragraph{aFRR data.} aFRR data is not available through Nord Pool, but
 through the NUCS API,
historical aFRR procurement prices and volumes for the NO1 bidding zone 
are accessible. The data is available at an hourly resolution, with separate
values for up- and down-regulation. This data provides insights into the amount 
of balancing that is expected to be needed in the system. 

\paragraph{mFRR CM.} Capacity market data for mFRR was hard to come by, but
eventually, NUCS was found to provide historical mFRR capacity market prices and
volumes for the NO1 bidding zone through their API. As discussed in the
literature review, Svedlindh and Yngvesson
\autocite{svedlindhPriceFormationForecasting2025} found that mFRR capacity
market data was their most important feature for predicting mFRR activations.
This study conducted day-ahead predictions, however, where capacity market data
is more relevant. In a closer-to-real-time setting, the importance of capacity
market data may be reduced, as the system state is better known closer to
real-time. Still, mFRR capacity market data can provide valuable insights into
the expected balancing needs in the system. 


\subsubsection{ENTSO-E}
ENTSO-E, the European Network of Transmission System Operators for Electricity,
is a key organization in the European electricity market. ENTSO-E provides
a wide range of data related to electricity generation, consumption, and grid
operations across Europe \autocite{DataStandardisation}.

\paragraph{aFRR Activation Data}
aFRR prices and capacities are available through NUCS as discussed earlier, but
aFRR activation data is not. However, ENTSO-E provides detailed data on aFRR 
regulations via their "Accepted Offers and Activated Balancing Reserves" dataset.
This dataset is supposed to provide information about up and down regulations from 
all balancing markets. Only aFRR data seems to be available, however, which is
sufficient for this project. The data is available at an hourly resolution, which
is coarser than the 15-minute resolution of the mFRR data. This data is, in the same
manner as other 1-hour resolution data, resampled with forward filling to match the
15-minute resolution of the main dataset.





\subsection{Data Preprocessing and Analysis}\label{sec:data_preprocessing_and_analysis}

\subsubsection{Dataset Structure}\label{sec:dataset_structure}
The data is represented as a time series, where each record in the dataset
consists of a set of attributes connected to one point in time. More
specifically, the data contains a sequence of 15-minute interval time
stamps. Each time stamp may or may not have an associated activation, which
is the target variable the model is trying to predict. The features
describe the system state at that time stamp, providing context for the
model to learn from.

\subsubsection{Resampling, Imputation, and Merging}
Nordic power market data is transitioning from hourly to 15-minute
resolution. However, many datasets are still only available at an hourly
resolution, and some datasets have mixed resolutions over the past years.
Day ahead price data, for instance, transitioned to 15-minute market time units 
(MTU) on September 30th 2025 \autocite{Transition15minuteMarketa}. Consequently, 
data before this date is at an hourly resolution, while data after this date is at a
15-minute resolution. mFRR activation data transitioned to 15-minute MTU on
\autocite{statnettConfirmationMFRREAM2025}, but Nord Pool has updated 
their historical data to be at a 15-minute resolution for the entire dataset
period. 

To ensure consistency across all datasets, all data with hourly 
resolution data subsets are resampled to a 15-minute resolution. This is done using
the built-in Pandas \texttt{resample()} function with forward filling. Forward filling
entails propagating the last valid observation forward to fill gaps. For instance,
if the day-ahead price between 10:00 and 11:00 is 50 EUR/MWh, then after resampling,
the price for 10:00, 10:15, 10:30, and 10:45 will all be set to 50 EUR/MWh, as 
illustrated in Figure \ref{fig:resampling_viz}. Thus, the data still remains 
constant within the hour, but is now available at the desired 15-minute resolution.


\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{Images/resampling_viz.png}
    \caption{Visualization of resampling from 1-hour to 15-minute resolution using
    forward filling.}
    \label{fig:resampling_viz}
\end{figure}

The handling, or \textit{imputation}, of missing values, is an important step in
data preprocessing. In time-dependent data, simply removing the rows with
missing values is problematic, as it would break the time continuity. Most of
the datasets used in this project do not have significant issues with missing
values, but for the few that do, interpolation or forward/backward filling
techniques are used to estimate the missing values based on surrounding data
points. Interpolation is often preferred, as it can provide smoother estimates,
as it considers both previous and subsequent data points. Backward filling is
used when missing values are at the beginning of the dataset, as there are no
previous data points to reference. Otherwise, forward filling is used as the
default method, as it maintains the most recent known value, thus preventing
time leakage from future data points \autocite{ribeiroMissingDataTime2022}.

After resampling and handling missing values, the various datasets are merged
into a single dataset. A successful merge requires that all datasets share a common
time index format and resolution. Datasets from different sources often differ 
in time zone and how time stamps are encoded. Therefore, all time stamps are converted to
a common time zone (CET/CEST) and format (Pandas \texttt{to\_datetime()} function) before  
merging. The final merged dataset contains all data aligned at a 15-minute resolution, 
ready for feature engineering and model training.




\subsubsection{Exploratory Data Analysis}

\paragraph{Activation Direction Imbalance.}\label{sec:class_imbalance} Figure
\ref{fig:mFRR_activation_distribution} displays the distribution of mFRR
activations over the dataset period (2024-2025). The figure especially
highlights the infrequent nature of up-activations, which occur far less often
than down-activations. This class imbalance is a critical consideration for the
prediction task, which in general makes it more challenging for models to
accurately predict the minority class \autocite{ClassImbalanceProblem}. The
predominance of no-activation contextualizes the zero-inflated nature of the
imbalance volumes, as discussed in the literature review. The classification
formulation adopted in this project makes zero-volume intervals a discrete
target class, reducing noise from volume magnitude variations within activation
classes.


\begin{figure}[H]
    \centering
    \includegraphics[width=0.85\textwidth]{Images/mfrr_distribution.png}
    \caption{mFRR activation direction distribution.}
    \label{fig:mFRR_activation_distribution}
\end{figure}

The distribution also reveals the majority class with 56,9\% of
all intervals having no activation. Activations occur in 43,1\% of the intervals,
with down-activations being the most common at 32,5\% and up-activations
being the least common at 10,6\%. Thus, if one were to consider the binary case
of activation vs. no activation, the classes would be approximately balanced.
Distinguishing between up- and down-activations, however, makes the problem
more nuanced and challenging.

\paragraph{Cross-zonal Flows.}

Figure \ref{fig:cross_zonal_flows_dist} shows the distribution of cross-zonal flow
directions for the NO1 bidding zone. The figure indicates that flows between NO1
and NO3, NO5, and SE3 are drastically skewed towards imports into NO1, while flows 
between NO1 and NO2 are reversely skewed. NO1-NO3 and NO1-NO5 show the most
pronounced skewness, with very few occurrences of exports from NO1 to these zones.
\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{Images/cross_zonal_flows_distribution_bar.png}
    \caption{Cross-zonal flow distributions for the NO1 bidding zone.}
    \label{fig:cross_zonal_flows_dist}
\end{figure}

Figure \ref{fig:cross_zonal_imports} and \ref{fig:cross_zonal_exports} show the 
relative utilization of the cross-zonal connections for NO1 as density plots. The
figures illustrate how heavily the connections are utilized for imports and exports,
respectively. The utilization is calculated as the ratio between actual flow and
the NTC (Net Transfer Capacity) capacity of the connection. The export utilization
figure highlights the lack of exports from NO1, except for the NO2 connection, 
indicated by the tail thickness between 0.4 and 1.0 utilization. The import
utilization figure, on the other hand, shows that all connections, except NO2-NO1,
are heavily utilized for imports, with many thick tails approaching full utilization.
The NO1-NO2 connection is thus almost exclusively used for exports from NO1 to NO2, 
whilst the other connections are primarily used for imports into NO1.

\begin{figure}[H]
    \centering
    \begin{subfigure}[t]{0.49\textwidth}
        \centering
        \includegraphics[width=\linewidth]{Images/import_utilization.png}
        \caption{Import utilization.}
        \label{fig:cross_zonal_imports}
    \end{subfigure}
    \hfill
    \begin{subfigure}[t]{0.49\textwidth}
        \centering
        \includegraphics[width=\linewidth]{Images/export_utilization.png}
        \caption{Export utilization.}
        \label{fig:cross_zonal_exports}
    \end{subfigure}
    \caption{Cross-zonal flow utilizations for the NO1 bidding zone calculated
    as the ratio between actual flow and NTC capacity.}
    \label{fig:cross_zonal_flows_side_by_side}
\end{figure}

\textbf{Production.}
Table \ref{tab:wind_feature_stats} summarizes key statistics for NO1 wind-related
features in the dataset (from 2024 to 2025). The statistics include mean,
standard deviation, minimum, various percentiles (P10, P50, P90), maximum, and the number of
observations for each feature. The features encompass day-ahead and intraday
wind forecasts, actual wind production, forecast revisions, forecast errors, 
and the share of wind in total production. The mean wind production revision 
(from intraday to day-ahead) is 12.59 MW, with a standard deviation of 15.27 MW. 
When compared with the mean actual production of 120.38 MW, this indicates that
wind errors are quite significant. This is a positive sign for the relevance
of wind-related features in predicting mFRR activations, as intraday-day-ahead
discrepencies can lead to imbalances requiring mFRR activations.

While wind-related variables capture an important weather-driven source of
uncertainty, additional meteorological features (e.g., temperature, precipitation,
wind speed/gusts, and pressure forecasts) could plausibly improve performance by
explaining variation in both demand and renewable production. Such features were
not included in this study due to scope and data integration constraints, and are
left as a natural extension for future work.

\begin{table}[H]
\centering
\caption{Summary statistics for wind-related features (2024--2025, NO1)}
\begin{tabular}{lrrrrrrrr}
\toprule
Metric & Mean & Std & Min & P10 & P50 & P90 & Max\\
\midrule
Wind DA Forecast        & 121.64 & 96.34 & 0.0   & 16.0   & 95.0   & 274.0  & 370.0  \\
Wind Intraday Forecast  & 135.80 & 104.55 & 0.0  & 15.0   & 111.0  & 294.0  & 376.0  \\
Wind Actual Production  & 120.38 & 102.72 & 0.0  & 8.0    & 91.0   & 283.0  & 380.0   \\
Wind Revision (ID--DA)  & 12.59  & 15.27  & 0.0  & 1.0    & 7.0    & 30.0   & 151.0  \\
DA--Actual Error        & 0.03   & 38.85  & -250.0& -44.0  & -2.0   & 47.0   & 221.0   \\
ID--Actual Error        & 2.97   & 35.30  & -227.0& -38.0  & 1.0    & 46.0   & 189.7   \\
Abs DA Error (\%)       & 0.58   & 0.99   & 0.0  & 0.038  & 0.24   & 1.36   & 5.0  \\
Abs ID Error (\%)       & 0.42   & 0.75   & 0.0  & 0.032  & 0.19   & 0.92   & 5.0   \\
Wind Share              & 0.054  & 0.047  & 0.0  & 0.0036 & 0.040  & 0.128  & 0.228  \\
\bottomrule
\end{tabular}
\label{tab:wind_feature_stats}
\end{table}

\paragraph{aFRR.}


Figure \ref{fig:nucs_afrr_hourly_hist} and \ref{fig:nucs_afrr_hourly_prices} show
a histogram and time series plot of the hourly NO1 aFRR "up" procurement prices between
January 1, 2024, and \lastDate. Both figures highlight a problem in pre-July 2024
data, as this period contains many missing values. The problem seeems to be 
intermittent missing values rather than large gaps of missing data, indicated by the 
time series plot. Interpolation is thus a suitable imputation method, as it can estimate
the missing values based on surrounding data points. This may miss out on some 
extreme price spikes, but is still expected to provide a reasonable estimate.
The data appears complete after this date. This phenomenon is consistent for 
both up- and down-regulation prices and volumes.


\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{Images/nucs_afrr_hourly_hist.png}
    \caption{A histogram of hourly aFRR "up" procurement prices for the NO1
bidding zone from NUCS data.}
    \label{fig:nucs_afrr_hourly_hist}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{Images/nucs_afrr_hourly_prices.png}
    \caption{Hourly aFRR "up" procurement prices for the NO1 bidding zone from NUCS data.}
    \label{fig:nucs_afrr_hourly_prices}
\end{figure}
